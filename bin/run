#!/usr/bin/env ruby
require "pry"
require_relative "env.rb"
require "yaml"

if ARGV[0].blank?
  puts "Missing required path to simulation configuration"
  exit
end

save_name = ARGV[1].presence || File.basename(ARGV[0], '.yml')
save_path = File.join(ROOT_DIR, "simulations", save_name)
FileUtils.mkdir_p(save_path)
simulation = Retirelator.from_params YAML.load_file(ARGV[0])
puts "Saving initial simuation to #{save_path}"
Retirelator.save(simulation, save_path)
simulation.simulate!
puts "Saving completed simuation to #{save_path}"
Retirelator.save(simulation, save_path)
